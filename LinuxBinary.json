[
    {
        "folder_name": "CVE-2024-47673",
        "files": [
            {
                "filename": "ops.iwl_mvm_stop_device.after.32.o.json",
                "state": "after",
                "interference": "32",
                "asm": {
                    "1": "push    ebp",
                    "2": "mov     ebp, esp",
                    "3": "push    edi",
                    "4": "push    esi",
                    "5": "push    ebx",
                    "6": "mov     ebx, eax",
                    "7": "lea     edi, [eax+880h]",
                    "8": "lock and byte ptr [eax+5Ch], 0BFh",
                    "9": "xor     edx, edx",
                    "10": "call    iwl_mvm_pause_tcm",
                    "11": "mov     eax, edi",
                    "12": "call    iwl_fw_dbg_stop_sync",
                    "13": "mov     esi, [ebx+4]",
                    "14": "call    __cond_resched",
                    "15": "mov     eax, [esi]",
                    "16": "mov     edx, [eax+10h]",
                    "17": "mov     eax, esi",
                    "18": "call    __x86_indirect_thunk_edx",
                    "19": "mov     eax, edi",
                    "20": "mov     dword ptr [esi+14h], 0",
                    "21": "call    iwl_free_fw_paging",
                    "22": "mov     byte ptr [ebx+0BF0h], 0FFh",
                    "23": "pop     ebx",
                    "24": "pop     esi",
                    "25": "pop     edi",
                    "26": "pop     ebp",
                    "27": "retn"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.after.arch64.o.json",
                "state": "after",
                "interference": "arch64",
                "asm": {
                    "1": "PACIASP",
                    "2": "STP             X29, X30, [SP,#-0x20+var_s0]!",
                    "3": "ADD             X1, X0, #0xB0",
                    "4": "MOV             X29, SP",
                    "5": "STP             X19, X20, [SP,#var_s10]",
                    "6": "MOV             X19, X0",
                    "7": "ADD             X20, X0, #0xE88",
                    "8": "MOV             X0, #6",
                    "9": "BL              clear_bit",
                    "10": "MOV             W1, #0",
                    "11": "MOV             X0, X19",
                    "12": "BL              iwl_mvm_pause_tcm",
                    "13": "MOV             X0, X20",
                    "14": "BL              iwl_fw_dbg_stop_sync",
                    "15": "LDR             X19, [X19,#8]",
                    "16": "BL              __cond_resched",
                    "17": "LDR             X0, [X19]",
                    "18": "LDR             X1, [X0,#0x20]",
                    "19": "MOV             X0, X19",
                    "20": "BLR             X1",
                    "21": "STR             WZR, [X19,#0x28]",
                    "22": "MOV             X0, X20",
                    "23": "BL              iwl_free_fw_paging",
                    "24": "MOV             W0, #0xFFFFFFFF",
                    "25": "STRB            W0, [X20,#0x630]",
                    "26": "LDP             X19, X20, [SP,#var_s10]",
                    "27": "LDP             X29, X30, [SP+var_s0],#0x20",
                    "28": "AUTIASP",
                    "29": "RET"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.after.clang.o.json",
                "state": "after",
                "interference": "clang",
                "asm": {
                    "1": "push    r15",
                    "2": "push    r14",
                    "3": "push    rbx",
                    "4": "mov     rbx, rdi",
                    "5": "lea     r14, [rdi+0E88h]",
                    "6": "lock and byte ptr [rdi+0B0h], 0BFh",
                    "7": "xor     esi, esi",
                    "8": "call    iwl_mvm_pause_tcm; PIC mode",
                    "9": "mov     rdi, r14",
                    "10": "call    iwl_fw_dbg_stop_sync; PIC mode",
                    "11": "mov     r15, [rbx+8]",
                    "12": "call    __cond_resched; PIC mode",
                    "13": "mov     rax, [r15]",
                    "14": "mov     r11, [rax+20h]",
                    "15": "mov     rdi, r15",
                    "16": "call    __x86_indirect_thunk_r11; PIC mode",
                    "17": "mov     dword ptr [r15+28h], 0",
                    "18": "mov     rdi, r14",
                    "19": "call    iwl_free_fw_paging; PIC mode",
                    "20": "mov     byte ptr [rbx+14B8h], 0FFh",
                    "21": "pop     rbx",
                    "22": "pop     r14",
                    "23": "pop     r15",
                    "24": "retn"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.after.o.json",
                "state": "after",
                "interference": "none",
                "asm": {
                    "1": "push    r12",
                    "2": "lea     r12, [rdi+0E88h]",
                    "3": "push    rbp",
                    "4": "push    rbx",
                    "5": "mov     rbx, rdi",
                    "6": "lock and byte ptr [rdi+0B0h], 0BFh",
                    "7": "xor     esi, esi",
                    "8": "call    iwl_mvm_pause_tcm; PIC mode",
                    "9": "mov     rdi, r12",
                    "10": "call    iwl_fw_dbg_stop_sync; PIC mode",
                    "11": "mov     rbp, [rbx+8]",
                    "12": "call    __cond_resched; PIC mode",
                    "13": "mov     rax, [rbp+0]",
                    "14": "mov     rdi, rbp",
                    "15": "mov     rax, [rax+20h]",
                    "16": "call    __x86_indirect_thunk_rax; PIC mode",
                    "17": "mov     dword ptr [rbp+28h], 0",
                    "18": "mov     rdi, r12",
                    "19": "call    iwl_free_fw_paging; PIC mode",
                    "20": "mov     byte ptr [rbx+14B8h], 0FFh",
                    "21": "pop     rbx",
                    "22": "pop     rbp",
                    "23": "pop     r12",
                    "24": "jmp     __x86_return_thunk; PIC mode"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.after.Os.o.json",
                "state": "after",
                "interference": "Os",
                "asm": {
                    "1": "push    r12",
                    "2": "lea     r12, [rdi+0E88h]",
                    "3": "push    rbp",
                    "4": "push    rbx",
                    "5": "mov     rbx, rdi",
                    "6": "lock and byte ptr [rdi+0B0h], 0BFh",
                    "7": "xor     esi, esi",
                    "8": "call    iwl_mvm_pause_tcm; PIC mode",
                    "9": "mov     rdi, r12",
                    "10": "call    iwl_fw_dbg_stop_sync; PIC mode",
                    "11": "mov     rbp, [rbx+8]",
                    "12": "call    __cond_resched; PIC mode",
                    "13": "mov     rax, [rbp+0]",
                    "14": "mov     rdi, rbp",
                    "15": "mov     rax, [rax+20h]",
                    "16": "call    __x86_indirect_thunk_rax; PIC mode",
                    "17": "mov     dword ptr [rbp+28h], 0",
                    "18": "mov     rdi, r12",
                    "19": "call    iwl_free_fw_paging; PIC mode",
                    "20": "mov     byte ptr [rbx+14B8h], 0FFh",
                    "21": "pop     rbx",
                    "22": "pop     rbp",
                    "23": "pop     r12",
                    "24": "jmp     __x86_return_thunk; PIC mode"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.before.32.o.json",
                "state": "before",
                "interference": "32",
                "asm": {
                    "1": "push    ebp",
                    "2": "mov     ebp, esp",
                    "3": "push    edi",
                    "4": "push    esi",
                    "5": "push    ebx",
                    "6": "mov     ebx, eax",
                    "7": "lea     edi, [eax+880h]",
                    "8": "lock and byte ptr [eax+5Ch], 0BFh",
                    "9": "mov     eax, edi",
                    "10": "call    iwl_fw_dbg_stop_sync",
                    "11": "mov     esi, [ebx+4]",
                    "12": "call    __cond_resched",
                    "13": "mov     eax, [esi]",
                    "14": "mov     edx, [eax+10h]",
                    "15": "mov     eax, esi",
                    "16": "call    __x86_indirect_thunk_edx",
                    "17": "mov     eax, edi",
                    "18": "mov     dword ptr [esi+14h], 0",
                    "19": "call    iwl_free_fw_paging",
                    "20": "mov     byte ptr [ebx+0BF0h], 0FFh",
                    "21": "pop     ebx",
                    "22": "pop     esi",
                    "23": "pop     edi",
                    "24": "pop     ebp",
                    "25": "retn"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.before.arch64.o.json",
                "state": "before",
                "interference": "arch64",
                "asm": {
                    "1": "PACIASP",
                    "2": "STP             X29, X30, [SP,#-0x20+var_s0]!",
                    "3": "ADD             X1, X0, #0xB0",
                    "4": "MOV             X29, SP",
                    "5": "STP             X19, X20, [SP,#var_s10]",
                    "6": "MOV             X19, X0",
                    "7": "ADD             X20, X0, #0xE88",
                    "8": "MOV             X0, #6",
                    "9": "BL              clear_bit",
                    "10": "MOV             X0, X20",
                    "11": "BL              iwl_fw_dbg_stop_sync",
                    "12": "LDR             X19, [X19,#8]",
                    "13": "BL              __cond_resched",
                    "14": "LDR             X0, [X19]",
                    "15": "LDR             X1, [X0,#0x20]",
                    "16": "MOV             X0, X19",
                    "17": "BLR             X1",
                    "18": "STR             WZR, [X19,#0x28]",
                    "19": "MOV             X0, X20",
                    "20": "BL              iwl_free_fw_paging",
                    "21": "MOV             W0, #0xFFFFFFFF",
                    "22": "STRB            W0, [X20,#0x630]",
                    "23": "LDP             X19, X20, [SP,#var_s10]",
                    "24": "LDP             X29, X30, [SP+var_s0],#0x20",
                    "25": "AUTIASP",
                    "26": "RET"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.before.clang.o.json",
                "state": "before",
                "interference": "clang",
                "asm": {
                    "1": "push    r15",
                    "2": "push    r14",
                    "3": "push    rbx",
                    "4": "mov     r15, rdi",
                    "5": "lea     r14, [rdi+0E88h]",
                    "6": "lock and byte ptr [rdi+0B0h], 0BFh",
                    "7": "mov     rdi, r14",
                    "8": "call    iwl_fw_dbg_stop_sync; PIC mode",
                    "9": "mov     rbx, [r15+8]",
                    "10": "call    __cond_resched; PIC mode",
                    "11": "mov     rax, [rbx]",
                    "12": "mov     r11, [rax+20h]",
                    "13": "mov     rdi, rbx",
                    "14": "call    __x86_indirect_thunk_r11; PIC mode",
                    "15": "mov     dword ptr [rbx+28h], 0",
                    "16": "mov     rdi, r14",
                    "17": "call    iwl_free_fw_paging; PIC mode",
                    "18": "mov     byte ptr [r15+14B8h], 0FFh",
                    "19": "pop     rbx",
                    "20": "pop     r14",
                    "21": "pop     r15",
                    "22": "retn"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.before.o.json",
                "state": "before",
                "interference": "none",
                "asm": {
                    "1": "push    r12",
                    "2": "lea     r12, [rdi+0E88h]",
                    "3": "push    rbp",
                    "4": "push    rbx",
                    "5": "mov     rbx, rdi",
                    "6": "lock and byte ptr [rdi+0B0h], 0BFh",
                    "7": "mov     rdi, r12",
                    "8": "call    iwl_fw_dbg_stop_sync; PIC mode",
                    "9": "mov     rbp, [rbx+8]",
                    "10": "call    __cond_resched; PIC mode",
                    "11": "mov     rax, [rbp+0]",
                    "12": "mov     rdi, rbp",
                    "13": "mov     rax, [rax+20h]",
                    "14": "call    __x86_indirect_thunk_rax; PIC mode",
                    "15": "mov     dword ptr [rbp+28h], 0",
                    "16": "mov     rdi, r12",
                    "17": "call    iwl_free_fw_paging; PIC mode",
                    "18": "mov     byte ptr [rbx+14B8h], 0FFh",
                    "19": "pop     rbx",
                    "20": "pop     rbp",
                    "21": "pop     r12",
                    "22": "jmp     __x86_return_thunk; PIC mode"
                }
            },
            {
                "filename": "ops.iwl_mvm_stop_device.before.Os.o.json",
                "state": "before",
                "interference": "Os",
                "asm": {
                    "1": "push    r12",
                    "2": "lea     r12, [rdi+0E88h]",
                    "3": "push    rbp",
                    "4": "push    rbx",
                    "5": "mov     rbx, rdi",
                    "6": "lock and byte ptr [rdi+0B0h], 0BFh",
                    "7": "mov     rdi, r12",
                    "8": "call    iwl_fw_dbg_stop_sync; PIC mode",
                    "9": "mov     rbp, [rbx+8]",
                    "10": "call    __cond_resched; PIC mode",
                    "11": "mov     rax, [rbp+0]",
                    "12": "mov     rdi, rbp",
                    "13": "mov     rax, [rax+20h]",
                    "14": "call    __x86_indirect_thunk_rax; PIC mode",
                    "15": "mov     dword ptr [rbp+28h], 0",
                    "16": "mov     rdi, r12",
                    "17": "call    iwl_free_fw_paging; PIC mode",
                    "18": "mov     byte ptr [rbx+14B8h], 0FFh",
                    "19": "pop     rbx",
                    "20": "pop     rbp",
                    "21": "pop     r12",
                    "22": "jmp     __x86_return_thunk; PIC mode"
                }
            }
        ]
    }
]